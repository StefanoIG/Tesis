# Generated by Django 4.2.8 on 2025-11-25 04:02

from django.conf import settings
import django.core.validators
from django.db import migrations, models
import django.db.models.deletion
import uuid


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
        ('usuarios', '0001_initial'),
        ('sensores', '0001_initial'),
    ]

    operations = [
        migrations.CreateModel(
            name='CalendariosRiego',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('tipo_riego', models.CharField(choices=[('GOTEO', 'Goteo'), ('ASPERSION', 'Aspersión'), ('GRAVEDAD', 'Gravedad'), ('MICROASPERSION', 'Microaspersión'), ('MANUAL', 'Manual')], max_length=30)),
                ('frecuencia_dias', models.IntegerField(help_text='Cada cuántos días regar')),
                ('duracion_minutos', models.IntegerField(help_text='Duración del riego en minutos')),
                ('litros_por_riego', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('hora_inicio_recomendada', models.TimeField(help_text='Hora recomendada para regar')),
                ('dias_semana', models.JSONField(blank=True, default=list, help_text='Lista de días de la semana [0=Lunes, 6=Domingo]')),
                ('ajustar_por_lluvia', models.BooleanField(default=True)),
                ('ajustar_por_temperatura', models.BooleanField(default=False)),
                ('usa_sensores', models.BooleanField(default=False)),
                ('umbral_humedad_minimo', models.DecimalField(blank=True, decimal_places=2, help_text='Porcentaje mínimo de humedad para activar riego', max_digits=5, null=True)),
                ('umbral_humedad_maximo', models.DecimalField(blank=True, decimal_places=2, help_text='Porcentaje máximo de humedad para detener riego', max_digits=5, null=True)),
                ('es_activo', models.BooleanField(default=True)),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Calendario de Riego',
                'verbose_name_plural': 'Calendarios de Riego',
                'db_table': 'calendarios_riego',
            },
        ),
        migrations.CreateModel(
            name='CatalogosCultivos',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('nombre_cientifico', models.CharField(max_length=255)),
                ('nombre_comun', models.CharField(max_length=255, unique=True)),
                ('categoria', models.CharField(choices=[('FLORES', 'Flores'), ('FRUTAS', 'Frutas'), ('HORTALIZAS', 'Hortalizas'), ('GRANOS', 'Granos'), ('TUBERCULOS', 'Tubérculos'), ('ESPECIAS', 'Especias y Hierbas'), ('FORRAJES', 'Forrajes'), ('OTROS', 'Otros')], max_length=30)),
                ('variedades', models.JSONField(blank=True, default=list, help_text='Lista de variedades disponibles')),
                ('ph_minimo', models.DecimalField(decimal_places=1, default=5.5, max_digits=3)),
                ('ph_optimo_min', models.DecimalField(decimal_places=1, default=6.0, max_digits=3)),
                ('ph_optimo_max', models.DecimalField(decimal_places=1, default=7.0, max_digits=3)),
                ('ph_maximo', models.DecimalField(decimal_places=1, default=8.0, max_digits=3)),
                ('texturas_compatibles', models.JSONField(blank=True, default=list, help_text='Lista de texturas de suelo compatibles')),
                ('temperatura_min', models.DecimalField(decimal_places=1, help_text='°C', max_digits=4)),
                ('temperatura_optima_min', models.DecimalField(decimal_places=1, help_text='°C', max_digits=4)),
                ('temperatura_optima_max', models.DecimalField(decimal_places=1, help_text='°C', max_digits=4)),
                ('temperatura_max', models.DecimalField(decimal_places=1, help_text='°C', max_digits=4)),
                ('altitud_minima', models.IntegerField(default=0, help_text='metros sobre el nivel del mar')),
                ('altitud_maxima', models.IntegerField(default=5000, help_text='metros sobre el nivel del mar')),
                ('precipitacion_anual_min', models.IntegerField(help_text='mm/año')),
                ('precipitacion_anual_max', models.IntegerField(help_text='mm/año')),
                ('dias_germinacion', models.IntegerField(default=0)),
                ('dias_hasta_cosecha', models.IntegerField(help_text='Días desde siembra')),
                ('ciclos_por_anio', models.IntegerField(default=1)),
                ('frecuencia_riego_dias', models.IntegerField(default=7, help_text='Frecuencia recomendada de riego en días (sin sensores)')),
                ('litros_agua_por_planta_dia', models.DecimalField(blank=True, decimal_places=2, max_digits=6, null=True)),
                ('requiere_riego_constante', models.BooleanField(default=False)),
                ('rendimiento_promedio_hectarea', models.DecimalField(blank=True, decimal_places=2, help_text='Toneladas o unidades por hectárea', max_digits=10, null=True)),
                ('precio_mercado_promedio', models.DecimalField(blank=True, decimal_places=2, help_text='USD por kg o unidad', max_digits=10, null=True)),
                ('demanda_mercado', models.CharField(choices=[('MUY_ALTA', 'Muy Alta'), ('ALTA', 'Alta'), ('MEDIA', 'Media'), ('BAJA', 'Baja')], default='MEDIA', max_length=20)),
                ('nivel_dificultad', models.CharField(choices=[('FACIL', 'Fácil'), ('MODERADO', 'Moderado'), ('DIFICIL', 'Difícil'), ('EXPERTO', 'Experto')], default='MODERADO', max_length=20)),
                ('certificaciones_recomendadas', models.JSONField(blank=True, default=list, help_text='Lista de certificaciones relevantes')),
                ('permisos_requeridos_ecuador', models.JSONField(blank=True, default=list, help_text='Permisos AGROCALIDAD, MAG, etc.')),
                ('descripcion', models.TextField(blank=True, null=True)),
                ('plagas_comunes', models.JSONField(blank=True, default=list)),
                ('enfermedades_comunes', models.JSONField(blank=True, default=list)),
                ('compatibilidad_rotacion', models.JSONField(blank=True, default=list, help_text='Cultivos compatibles para rotación')),
                ('es_activo', models.BooleanField(default=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
            ],
            options={
                'verbose_name': 'Catálogo de Cultivo',
                'verbose_name_plural': 'Catálogos de Cultivos',
                'db_table': 'catalogos_cultivos',
                'ordering': ['categoria', 'nombre_comun'],
            },
        ),
        migrations.CreateModel(
            name='Parcelas',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('codigo_parcela', models.CharField(db_index=True, max_length=50)),
                ('nombre', models.CharField(max_length=255)),
                ('area_hectareas', models.DecimalField(decimal_places=4, max_digits=10)),
                ('geometria_svg', models.TextField(blank=True, help_text='Datos SVG para dibujar la parcela en el mapa', null=True)),
                ('coordenadas_geojson', models.JSONField(blank=True, default=dict, help_text='GeoJSON con las coordenadas de la parcela')),
                ('latitud_centro', models.DecimalField(blank=True, decimal_places=6, max_digits=9, null=True)),
                ('longitud_centro', models.DecimalField(blank=True, decimal_places=6, max_digits=9, null=True)),
                ('fecha_siembra_actual', models.DateField(blank=True, null=True)),
                ('estado_parcela', models.CharField(choices=[('DISPONIBLE', 'Disponible'), ('EN_USO', 'En Uso'), ('DESCANSO', 'En Descanso'), ('PREPARACION', 'En Preparación'), ('INACTIVA', 'Inactiva')], default='DISPONIBLE', max_length=30)),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('es_activa', models.BooleanField(default=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
                ('cultivo_actual', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='parcelas_actuales', to='planificacion.catalogoscultivos')),
                ('finca', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='parcelas', to='usuarios.fincas')),
            ],
            options={
                'verbose_name': 'Parcela',
                'verbose_name_plural': 'Parcelas',
                'db_table': 'parcelas',
                'ordering': ['finca', 'codigo_parcela'],
                'unique_together': {('finca', 'codigo_parcela')},
            },
        ),
        migrations.CreateModel(
            name='PermisosNacionalesEcuador',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('nombre_permiso', models.CharField(max_length=255)),
                ('codigo_permiso', models.CharField(max_length=100, unique=True)),
                ('tipo_permiso', models.CharField(choices=[('FITOSANITARIO', 'Fitosanitario'), ('AMBIENTAL', 'Ambiental'), ('USO_AGUA', 'Uso de Agua'), ('EXPORTACION', 'Exportación'), ('IMPORTACION', 'Importación'), ('PRODUCCION', 'Producción'), ('COMERCIALIZACION', 'Comercialización'), ('TRANSPORTE', 'Transporte'), ('OTRO', 'Otro')], max_length=30)),
                ('entidad_emisora', models.CharField(choices=[('AGROCALIDAD', 'AGROCALIDAD'), ('MAG', 'Ministerio de Agricultura y Ganadería'), ('MAATE', 'Ministerio del Ambiente'), ('ARCSA', 'ARCSA'), ('SENADI', 'SENADI (para exportación)'), ('GAD_MUNICIPAL', 'GAD Municipal'), ('GAD_PROVINCIAL', 'GAD Provincial'), ('OTRO', 'Otro')], max_length=30)),
                ('descripcion', models.TextField()),
                ('requisitos', models.JSONField(default=list, help_text='Lista de requisitos necesarios')),
                ('documentos_requeridos', models.JSONField(default=list, help_text='Lista de documentos requeridos')),
                ('aplica_todo_cultivo', models.BooleanField(default=False)),
                ('tiempo_tramite_dias', models.IntegerField(help_text='Días estimados para obtener el permiso')),
                ('vigencia_meses', models.IntegerField(help_text='Meses de vigencia del permiso')),
                ('costo_estimado', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('url_tramite', models.URLField(blank=True, null=True)),
                ('url_informacion', models.URLField(blank=True, null=True)),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('es_obligatorio', models.BooleanField(default=True)),
                ('es_activo', models.BooleanField(default=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
                ('cultivos_aplicables', models.ManyToManyField(blank=True, related_name='permisos_requeridos', to='planificacion.catalogoscultivos')),
            ],
            options={
                'verbose_name': 'Permiso Nacional Ecuador',
                'verbose_name_plural': 'Permisos Nacionales Ecuador',
                'db_table': 'permisos_nacionales_ecuador',
                'ordering': ['entidad_emisora', 'nombre_permiso'],
            },
        ),
        migrations.CreateModel(
            name='RegistrosRiego',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('fecha_hora_inicio', models.DateTimeField()),
                ('fecha_hora_fin', models.DateTimeField(blank=True, null=True)),
                ('duracion_real_minutos', models.IntegerField(blank=True, null=True)),
                ('litros_agua_utilizados', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('tipo_ejecucion', models.CharField(choices=[('AUTOMATICO', 'Automático (sensor)'), ('PROGRAMADO', 'Programado (calendario)'), ('MANUAL', 'Manual')], max_length=20)),
                ('temperatura_ambiente', models.DecimalField(blank=True, decimal_places=1, max_digits=4, null=True)),
                ('humedad_suelo_antes', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('humedad_suelo_despues', models.DecimalField(blank=True, decimal_places=2, max_digits=5, null=True)),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('incidencias', models.TextField(blank=True, null=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('calendario', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='registros_ejecucion', to='planificacion.calendariosriego')),
                ('ejecutado_por', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, to=settings.AUTH_USER_MODEL)),
            ],
            options={
                'verbose_name': 'Registro de Riego',
                'verbose_name_plural': 'Registros de Riego',
                'db_table': 'registros_riego',
                'ordering': ['-fecha_hora_inicio'],
            },
        ),
        migrations.CreateModel(
            name='PlanesCultivo',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('fecha_planificada_siembra', models.DateField()),
                ('fecha_estimada_cosecha', models.DateField()),
                ('fecha_real_siembra', models.DateField(blank=True, null=True)),
                ('fecha_real_cosecha', models.DateField(blank=True, null=True)),
                ('variedad', models.CharField(blank=True, max_length=100, null=True)),
                ('cantidad_plantas', models.IntegerField(blank=True, null=True)),
                ('densidad_siembra', models.CharField(blank=True, help_text='Ej: 2x3 metros, 30cm entre plantas', max_length=100, null=True)),
                ('estado', models.CharField(choices=[('PROPUESTA', 'Propuesta'), ('APROBADO', 'Aprobado'), ('EN_EJECUCION', 'En Ejecución'), ('COMPLETADO', 'Completado'), ('CANCELADO', 'Cancelado')], default='PROPUESTA', max_length=20)),
                ('progreso_porcentaje', models.IntegerField(default=0, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('compatibilidad_suelo', models.IntegerField(default=0, help_text='Porcentaje de compatibilidad basado en estudio de suelo', validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(100)])),
                ('motivo_seleccion', models.TextField(blank=True, help_text='Por qué se eligió este cultivo', null=True)),
                ('recomendaciones_ia', models.JSONField(blank=True, default=dict, help_text='Recomendaciones generadas por el sistema')),
                ('inversion_estimada', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('ingreso_proyectado', models.DecimalField(blank=True, decimal_places=2, max_digits=12, null=True)),
                ('roi_estimado', models.DecimalField(blank=True, decimal_places=2, help_text='Retorno de inversión en porcentaje', max_digits=5, null=True)),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
                ('creado_por', models.ForeignKey(null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='planes_cultivo_creados', to=settings.AUTH_USER_MODEL)),
                ('cultivo', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='planes', to='planificacion.catalogoscultivos')),
                ('parcela', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='planes_cultivo', to='planificacion.parcelas')),
            ],
            options={
                'verbose_name': 'Plan de Cultivo',
                'verbose_name_plural': 'Planes de Cultivo',
                'db_table': 'planes_cultivo',
                'ordering': ['-fecha_planificada_siembra'],
            },
        ),
        migrations.CreateModel(
            name='PermisosObtenidos',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('numero_permiso', models.CharField(max_length=100, unique=True)),
                ('fecha_emision', models.DateField()),
                ('fecha_vencimiento', models.DateField()),
                ('estado', models.CharField(choices=[('EN_TRAMITE', 'En Trámite'), ('VIGENTE', 'Vigente'), ('POR_RENOVAR', 'Por Renovar'), ('VENCIDO', 'Vencido'), ('RECHAZADO', 'Rechazado')], default='EN_TRAMITE', max_length=20)),
                ('archivo_permiso', models.FileField(blank=True, null=True, upload_to='permisos/')),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
                ('empresa', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='permisos_obtenidos', to='usuarios.empresas')),
                ('finca', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='permisos_obtenidos', to='usuarios.fincas')),
                ('permiso', models.ForeignKey(on_delete=django.db.models.deletion.PROTECT, related_name='permisos_obtenidos', to='planificacion.permisosnacionalesecuador')),
            ],
            options={
                'verbose_name': 'Permiso Obtenido',
                'verbose_name_plural': 'Permisos Obtenidos',
                'db_table': 'permisos_obtenidos',
                'ordering': ['-fecha_emision'],
            },
        ),
        migrations.CreateModel(
            name='EstudiosSuelo',
            fields=[
                ('id', models.UUIDField(default=uuid.uuid4, editable=False, primary_key=True, serialize=False)),
                ('nombre', models.CharField(max_length=255)),
                ('fecha_estudio', models.DateField()),
                ('laboratorio', models.CharField(blank=True, max_length=255, null=True)),
                ('archivo_pdf', models.FileField(blank=True, help_text='PDF del estudio de suelo', null=True, upload_to='estudios_suelo/')),
                ('ph', models.DecimalField(blank=True, decimal_places=1, max_digits=3, null=True, validators=[django.core.validators.MinValueValidator(0), django.core.validators.MaxValueValidator(14)])),
                ('textura', models.CharField(blank=True, choices=[('ARENOSO', 'Arenoso'), ('LIMOSO', 'Limoso'), ('ARCILLOSO', 'Arcilloso'), ('FRANCO', 'Franco'), ('FRANCO_ARENOSO', 'Franco Arenoso'), ('FRANCO_ARCILLOSO', 'Franco Arcilloso'), ('FRANCO_LIMOSO', 'Franco Limoso')], max_length=30, null=True)),
                ('nitrogeno', models.DecimalField(blank=True, decimal_places=2, help_text='N en ppm', max_digits=10, null=True)),
                ('fosforo', models.DecimalField(blank=True, decimal_places=2, help_text='P en ppm', max_digits=10, null=True)),
                ('potasio', models.DecimalField(blank=True, decimal_places=2, help_text='K in ppm', max_digits=10, null=True)),
                ('calcio', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('magnesio', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('azufre', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('hierro', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('manganeso', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('zinc', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('cobre', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('boro', models.DecimalField(blank=True, decimal_places=2, max_digits=10, null=True)),
                ('materia_organica', models.DecimalField(blank=True, decimal_places=2, help_text='Porcentaje', max_digits=5, null=True)),
                ('conductividad_electrica', models.DecimalField(blank=True, decimal_places=2, help_text='dS/m', max_digits=10, null=True)),
                ('capacidad_intercambio_cationico', models.DecimalField(blank=True, decimal_places=2, help_text='meq/100g', max_digits=10, null=True)),
                ('observaciones', models.TextField(blank=True, null=True)),
                ('recomendaciones_laboratorio', models.TextField(blank=True, null=True)),
                ('datos_adicionales', models.JSONField(blank=True, default=dict)),
                ('es_vigente', models.BooleanField(default=True)),
                ('creado_en', models.DateTimeField(auto_now_add=True)),
                ('actualizado_en', models.DateTimeField(auto_now=True)),
                ('finca', models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='estudios_suelo', to='usuarios.fincas')),
                ('parcela', models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.CASCADE, related_name='estudios_suelo', to='planificacion.parcelas')),
            ],
            options={
                'verbose_name': 'Estudio de Suelo',
                'verbose_name_plural': 'Estudios de Suelo',
                'db_table': 'estudios_suelo',
                'ordering': ['-fecha_estudio'],
            },
        ),
        migrations.AddField(
            model_name='calendariosriego',
            name='plan_cultivo',
            field=models.ForeignKey(on_delete=django.db.models.deletion.CASCADE, related_name='calendarios_riego', to='planificacion.planescultivo'),
        ),
        migrations.AddField(
            model_name='calendariosriego',
            name='sensor_humedad',
            field=models.ForeignKey(blank=True, null=True, on_delete=django.db.models.deletion.SET_NULL, related_name='calendarios_riego', to='sensores.dispositivossensores'),
        ),
    ]
